<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ±</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Ø£Ø¶Ù Ù‡Ù†Ø§ ØªÙ†Ø³ÙŠÙ‚Ø§Øª CSS Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ */
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸŒŸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¶ÙˆØ±</h1>
    </header>

    <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ -->
    <section id="members">
      <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</h2>
      <button onclick="showAddMemberForm()">Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ</button>
      <table id="membersTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ</th>
            <th>Ø§Ù„Ù†Ù‚Ø§Ø·</th>
            <th>ØªØ¹Ø¯ÙŠÙ„</th>
            <th>Ø­Ø°Ù</th>
          </tr>
        </thead>
        <tbody>
          <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ù†Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript -->
        </tbody>
      </table>
    </section>

    <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹ -->
    <section id="weeks">
      <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹</h2>
      <button onclick="showAddWeekForm()">Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¨ÙˆØ¹</button>
      <table id="weeksTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th>
            <th>Ù…Ù†</th>
            <th>Ø¥Ù„Ù‰</th>
            <th>ØªØ¹Ø¯ÙŠÙ„</th>
            <th>Ø­Ø°Ù</th>
          </tr>
        </thead>
        <tbody>
          <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ù†Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript -->
        </tbody>
      </table>
    </section>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ -->
    <div id="addMemberForm" style="display:none;">
      <h3>Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯</h3>
      <label for="memberName">Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ:</label>
      <input type="text" id="memberName" required>
      <label for="weekSelect">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹:</label>
      <select id="weekSelect"></select>
      <button onclick="addMember()">Ø¥Ø¶Ø§ÙØ©</button>
      <button onclick="closeAddMemberForm()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¨ÙˆØ¹ -->
    <div id="addWeekForm" style="display:none;">
      <h3>Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¨ÙˆØ¹ Ø¬Ø¯ÙŠØ¯</h3>
      <label for="weekName">Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹:</label>
      <input type="text" id="weekName" required>
      <label for="startDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</label>
      <input type="date" id="startDate" required>
      <label for="endDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©:</label>
      <input type="date" id="endDate" required>
      <button onclick="addWeek()">Ø¥Ø¶Ø§ÙØ©</button>
      <button onclick="closeAddWeekForm()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
  </div>

  <script>
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.onload = function() {
      loadMembers();
      loadWeeks();
    };

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡
    function loadMembers() {
      google.script.run.withSuccessHandler(function(members) {
        const tableBody = document.querySelector('#membersTable tbody');
        tableBody.innerHTML = '';
        members.forEach(function(member, index) {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${member.id}</td>
            <td>${member.name}</td>
            <td>${member.points}</td>
            <td><button onclick="editMember(${member.id})">ØªØ¹Ø¯ÙŠÙ„</button></td>
            <td><button onclick="deleteMember(${member.id})">Ø­Ø°Ù</button></td>
          `;
          tableBody.appendChild(row);
        });
      }).getMembers();
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹
    function loadWeeks() {
      google.script.run.withSuccessHandler(function(weeks) {
        const tableBody = document.querySelector('#weeksTable tbody');
        tableBody.innerHTML = '';
        weeks.forEach(function(week, index) {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${week.id}</td>
            <td>${week.name}</td>
            <td>${week.startDate}</td>
            <td>${week.endDate}</td>
            <td><button onclick="editWeek(${week.id})">ØªØ¹Ø¯ÙŠÙ„</button></td>
            <td><button onclick="deleteWeek(${week.id})">Ø­Ø°Ù</button></td>
          `;
          tableBody.appendChild(row);
        });
      }).getWeeks();
    }

    // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ
    function showAddMemberForm() {
      document.getElementById('addMemberForm').style.display = 'block';
      loadWeeksForSelect();
    }

    // Ø¥ØºÙ„Ø§Ù‚ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ
    function closeAddMemberForm() {
      document.getElementById('addMemberForm').style.display = 'none';
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹ Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±
    function loadWeeksForSelect() {
      google.script.run.withSuccessHandler(function(weeks) {
        const select = document.getElementById('weekSelect');
        select.innerHTML = '';
        weeks.forEach(function(week) {
          const option = document.createElement('option');
          option.value = week.id;
          option.textContent = week.name;
          select.appendChild(option);
        });
      }).getWeeks();
    }

    // Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ
    function addMember() {
      const name = document.getElementById('memberName').value;
      const week = document.getElementById('weekSelect').value;
      google.script.run.withSuccessHandler(function() {
        loadMembers();
        closeAddMemberForm();
      }).addMember(name, week);
    }

    // ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø¶Ùˆ
    function editMember(id) {
      // ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
    }

    // Ø­Ø°Ù Ø¹Ø¶Ùˆ
    function deleteMember(id) {
      google.script.run.withSuccessHandler(function() {
        loadMembers();
      }).deleteMember(id);
    }

    // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¨ÙˆØ¹
    function showAddWeekForm() {
      document.getElementById('addWeekForm').style.display = 'block';
    }

    // Ø¥ØºÙ„Ø§Ù‚ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¨ÙˆØ¹
    function closeAddWeekForm() {
      document.getElementById('addWeekForm').style.display = 'none';
    }

    // Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¨ÙˆØ¹
    function addWeek() {
      const name = document.getElementById('weekName').value;
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      google.script.run.withSuccessHandler(function() {
        loadWeeks();
        closeAddWeekForm();
      }).addWeek(name, startDate, endDate);
    }

    // ØªØ¹Ø¯ÙŠÙ„ Ø£Ø³Ø¨ÙˆØ¹
    function editWeek(id
::contentReference[oaicite:24]{index=24}
 
