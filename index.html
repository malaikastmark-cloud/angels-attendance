<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>إدارة الحضور</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* أضف هنا تنسيقات CSS الخاصة بك */
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>🌟 إدارة الحضور</h1>
    </header>

    <!-- إدارة الأعضاء -->
    <section id="members">
      <h2>إدارة الأعضاء</h2>
      <button onclick="showAddMemberForm()">إضافة عضو</button>
      <table id="membersTable">
        <thead>
          <tr>
            <th>#</th>
            <th>اسم العضو</th>
            <th>النقاط</th>
            <th>تعديل</th>
            <th>حذف</th>
          </tr>
        </thead>
        <tbody>
          <!-- سيتم ملء البيانات هنا باستخدام JavaScript -->
        </tbody>
      </table>
    </section>

    <!-- إدارة الأسابيع -->
    <section id="weeks">
      <h2>إدارة الأسابيع</h2>
      <button onclick="showAddWeekForm()">إضافة أسبوع</button>
      <table id="weeksTable">
        <thead>
          <tr>
            <th>#</th>
            <th>اسم الأسبوع</th>
            <th>من</th>
            <th>إلى</th>
            <th>تعديل</th>
            <th>حذف</th>
          </tr>
        </thead>
        <tbody>
          <!-- سيتم ملء البيانات هنا باستخدام JavaScript -->
        </tbody>
      </table>
    </section>

    <!-- نموذج إضافة عضو -->
    <div id="addMemberForm" style="display:none;">
      <h3>إضافة عضو جديد</h3>
      <label for="memberName">اسم العضو:</label>
      <input type="text" id="memberName" required>
      <label for="weekSelect">الأسبوع:</label>
      <select id="weekSelect"></select>
      <button onclick="addMember()">إضافة</button>
      <button onclick="closeAddMemberForm()">إغلاق</button>
    </div>

    <!-- نموذج إضافة أسبوع -->
    <div id="addWeekForm" style="display:none;">
      <h3>إضافة أسبوع جديد</h3>
      <label for="weekName">اسم الأسبوع:</label>
      <input type="text" id="weekName" required>
      <label for="startDate">تاريخ البداية:</label>
      <input type="date" id="startDate" required>
      <label for="endDate">تاريخ النهاية:</label>
      <input type="date" id="endDate" required>
      <button onclick="addWeek()">إضافة</button>
      <button onclick="closeAddWeekForm()">إغلاق</button>
    </div>
  </div>

  <script>
    // تحميل البيانات عند تحميل الصفحة
    window.onload = function() {
      loadMembers();
      loadWeeks();
    };

    // تحميل الأعضاء
    function loadMembers() {
      google.script.run.withSuccessHandler(function(members) {
        const tableBody = document.querySelector('#membersTable tbody');
        tableBody.innerHTML = '';
        members.forEach(function(member, index) {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${member.id}</td>
            <td>${member.name}</td>
            <td>${member.points}</td>
            <td><button onclick="editMember(${member.id})">تعديل</button></td>
            <td><button onclick="deleteMember(${member.id})">حذف</button></td>
          `;
          tableBody.appendChild(row);
        });
      }).getMembers();
    }

    // تحميل الأسابيع
    function loadWeeks() {
      google.script.run.withSuccessHandler(function(weeks) {
        const tableBody = document.querySelector('#weeksTable tbody');
        tableBody.innerHTML = '';
        weeks.forEach(function(week, index) {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${week.id}</td>
            <td>${week.name}</td>
            <td>${week.startDate}</td>
            <td>${week.endDate}</td>
            <td><button onclick="editWeek(${week.id})">تعديل</button></td>
            <td><button onclick="deleteWeek(${week.id})">حذف</button></td>
          `;
          tableBody.appendChild(row);
        });
      }).getWeeks();
    }

    // إظهار نموذج إضافة عضو
    function showAddMemberForm() {
      document.getElementById('addMemberForm').style.display = 'block';
      loadWeeksForSelect();
    }

    // إغلاق نموذج إضافة عضو
    function closeAddMemberForm() {
      document.getElementById('addMemberForm').style.display = 'none';
    }

    // تحميل الأسابيع للاختيار
    function loadWeeksForSelect() {
      google.script.run.withSuccessHandler(function(weeks) {
        const select = document.getElementById('weekSelect');
        select.innerHTML = '';
        weeks.forEach(function(week) {
          const option = document.createElement('option');
          option.value = week.id;
          option.textContent = week.name;
          select.appendChild(option);
        });
      }).getWeeks();
    }

    // إضافة عضو
    function addMember() {
      const name = document.getElementById('memberName').value;
      const week = document.getElementById('weekSelect').value;
      google.script.run.withSuccessHandler(function() {
        loadMembers();
        closeAddMemberForm();
      }).addMember(name, week);
    }

    // تعديل عضو
    function editMember(id) {
      // تنفيذ عملية التعديل
    }

    // حذف عضو
    function deleteMember(id) {
      google.script.run.withSuccessHandler(function() {
        loadMembers();
      }).deleteMember(id);
    }

    // إظهار نموذج إضافة أسبوع
    function showAddWeekForm() {
      document.getElementById('addWeekForm').style.display = 'block';
    }

    // إغلاق نموذج إضافة أسبوع
    function closeAddWeekForm() {
      document.getElementById('addWeekForm').style.display = 'none';
    }

    // إضافة أسبوع
    function addWeek() {
      const name = document.getElementById('weekName').value;
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      google.script.run.withSuccessHandler(function() {
        loadWeeks();
        closeAddWeekForm();
      }).addWeek(name, startDate, endDate);
    }

    // تعديل أسبوع
    function editWeek(id
::contentReference[oaicite:24]{index=24}
 
