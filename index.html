<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÿßÿ¨ÿ™ŸÖÿßÿπ ÿÆÿØÿßŸÖ ŸÖŸÑÿßŸäŸÉÿ©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 20px;
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #3498db, #2c3e50);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 12px;
            position: relative;
            margin-bottom: 25px;
        }
        
        header::before {
            content: "üßö‚Äç‚ôÇÔ∏è";
            position: absolute;
            left: 20px;
            top: 20px;
            font-size: 2rem;
        }
        
        header::after {
            content: "‚ú®";
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 2rem;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        .user-section {
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            margin-bottom: 20px;
            background: #fff;
            box-shadow: 0 3px ÊûÅÈÄüÂø´3
        }
        
        .admin-section {
            display: none;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            margin-top: 20px;
            background: #fff;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        th, td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #eaeaea;
        }
        
        th {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            font-weight: 600;
        }
        
        tr:nth-child(even) {
            background: #f9fafb;
        }
        
        tr:hover {
            background: #f1f3ÊûÅÈÄüÂø´3
            transition: background 0.2s;
        }
        
        .btn {
            padding: 12px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .btn i {
            margin-left: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(to right, #2ecc71, #27ae60);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, #27aeÊûÅÈÄüÂø´3
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .btn-success {
            background: linear-gradient(to rightÊûÅÈÄüÂø´3
            color: white;
        }
        
        .btn-success:hover {
            background: linear-gradient(to right, #2980b9, #1c6ea4);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .btn-danger {
            background: linear-gradient(to right, #e74c3c, #c0392b);
            color: white;
        }
        
        .btn-danger:hover {
            background: linear-gradient(to right, #c0392b, #a23526);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .btn-warning {
            background: linear-gradient(to right, #f39c12, #e67e22);
            color: white;
        }
        
        .btn-warning:hover {
            background: linear-gradient(to right, #e67e22, #d35400);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .btn-info {
            background: linear-gradient(to right, #9b59b6, #8e44ad);
            color: white;
        }
        
        .btn-info:hover {
            background: linear-gradient(to right, #8e44ad, #7d3c98);
            transform: translateY(-2px);
            box-shadow: 0 4ÊûÅÈÄüÂø´3
        }
        
        .controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        select, input {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #dcdcdc;
            min-width: 200px;
            font-size: 1rem;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: border 0.3s;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 12px;
            width: 450px;
            max-width: 90%;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 15ÊûÅÈÄüÂø´3
            flex-wrap: wrap;
        }
        
        .tabs .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-radius: 8px;
            background: #f0f2f5;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
        }
        
        .tabs .tab.active {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
        }
        
        .tabs .tab:hover {
            background: #e0e6ec;
        }
        
        .summary-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin: 10px;
            flex: 1;
            min-width: 220px;
            transition: transform 0.3s, box-shadow 0.3s;
            border: 1px solid #eaeaea;
        }
        
        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .summary-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .summary-value {
            font-size: 2.8rem;
            font-weight: bold;
            color: #2ecc71;
            margin: 15px 0;
        }
        
        .summary-subtitle {
            color: #7f8c8d;
            font-size: 0.95rem;
        }
        
        .card-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .notification {
            position: fixed;
            top: 25px;
            right: 25px;
            background: #2ecc71;
            color: white;
            padding: 18px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            zÊûÅÈÄüÂø´3
            display: none;
            animation: slideIn 0.5s;
            max-width: 350px;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .member-img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #3498db;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .export-buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .report-section {
            margin-bottom: 35px;
        }
        
        .report-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            font-size: 1.3rem;
        }
        
        .top-members-list {
            margin-top: 25px;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid #eaeaea;
        }
        
        .top-members-list h3 {
            color: #3498db;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.4rem;
        }
        
        .top-member-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid #eee;
            align-items: center;
            transition: background 0.2s;
        }
        
        .top-member-item:hover {
            background: #f8f9fa;
        }
        
        .top-member-item:last-child {
            border-bottom: none;
        }
        
        .top-member-name {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .top-member-points {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .medal {
            font-size: 1.8rem;
            margin-left: 8px;
        }
        
        .medal-gold {
            color: gold;
        }
        
        .medal-silver {
            color: silver;
        }
        
        .medal-bronze {
            color: #cd7f32;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-online {
            background: #2ecc71;
        }
        
        .status-offline {
            background: #e74c3c;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin: 30px 0;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .card-container {
                flex-direction: column;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .export-buttons {
                flex-direction: column;
            }
            
            header::before, header::after {
                display: none;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            select, input {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåü ÿßÿ¨ÿ™ŸÖÿßÿπ ÿÆÿØÿßŸÖ ŸÖŸÑÿßŸäŸÉÿ©</h1>
            <p class="subtitle">ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ - ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸàÿßŸÑŸÜŸÇÿßÿ∑</p>
            <p class="subtitle"><span class="status-indicator status-online"></span> ŸÖÿ™ÿµŸÑ ÿ®ÿßŸÑŸÜÿ∏ÿßŸÖ</p>
        </header>

        <div class="loading" id="loading">
            <div classÊûÅÈÄüÂø´3
            <p>ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...</p>
        </div>

        <!-- ŸÇÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿπÿßÿØŸä -->
        <div class="user-section">
            <h2>ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ±</h2>
            <div class="controls">
                <label>ÿßÿÆÿ™ÿ± ÿßÿ≥ŸÖŸÉ: </label>
                <select id="selectMember">
                    <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ -->
                </select>
                <label>ÿßÿÆÿ™ÿ± ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ: </label>
                <select id="weekSelect">
                    <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ -->
                </select>
            </div>
            <div class="controls">
                <button class="btn btn-primary" id="markPresent">
                    <i class="fas fa-check-circle"></i> ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
                </button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>ÿßŸÑÿµŸàÿ±ÿ©</th>
                        <ÊûÅÈÄüÂø´3
                        <th>ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ</th>
                        <th>ÿßŸÑÿ≠ÿ∂Ÿàÿ±</th>
                        <th>ÿßŸÑŸÜŸÇÿßÿ∑</th>
                    </tr>
                </thead>
                <tbody id="attendanceTableBody">
                    <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ -->
                </tbody>
            </table>
            <ÊûÅÈÄüÂø´3
                <span>ÿßŸÑÿ≠ÿ∂Ÿàÿ± Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ: <span id="attendanceCount">0</span>/<span id="totalMembers">0</span></span>
                <span>ÿßŸÑŸÜŸÇÿßÿ∑: <span id="totalPoints">0</span></span>
            </div>
            
            <div class="controls" style="margin-top:20px;">
                <button class="btn btn-success" id="adminLoginBtn">
                    <i class="fas fa-lock"></i> ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿßŸÑÿ£ÿØŸÖŸÜ
                </button>
            </div>
        </div>

        <!-- ŸÇÿ≥ŸÖ ÿßŸÑÿ£ÿØŸÖŸÜ (Ÿäÿ∏Ÿáÿ± ŸÅŸÇÿ∑ ÿ®ÿπÿØ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ) -->
        <div class="admin-section" id="adminSection">
            <div class="controls">
                <button class="btn btn-warning" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨
                </button>
            </div>
            
            <div class="tabs" id="mainTabs">
                <div class="tab active" data-tab="members">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ÿπÿ∂ÿßÿ°</div>
                <div class="tab" data-tab="weeks">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ÿ≥ÿßÿ®Ÿäÿπ</div>
                <div class="tab" data-tab="attendance">ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±</div>
                <div class="tab" data-tab="reports">ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±</div>
            </div>

            <div class="tab-content active" id="members">
                <h2>ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ÿπÿ∂ÿßÿ°</h2>
                <div class="controls">
                    <input type="text" id="newMemberName" placeholder="ÿßÿ≥ŸÖ ÿßŸÑÿπÿ∂Ÿà">
                    <input type="text" id="newMemberImage" placeholder="ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿµŸàÿ±ÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)">
                    <button class="btn btn-primaryÊûÅÈÄüÂø´3
                        <i class="fas fa-plus"></i> ÿ•ÿ∂ÿßŸÅÿ© ÿπÿ∂Ÿà
                    </button>
                </div>
                <table id="membersTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>ÿßŸÑÿµŸàÿ±ÿ©</th>
                            <th>ÿßÿ≥ŸÖ ÿßŸÑÿπÿ∂Ÿà</th>
                            <th>ÿßŸÑŸÜŸÇÿßÿ∑</th>
                            <th>ÿ™ÿπÿØŸäŸÑ</th>
                            <th>ÿ≠ÿ∞ŸÅ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ -->
                    </tbody>
                </table>
            </div>

            <div class="tab-content" id="weeks">
                <h2>ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ÿ≥ÿßÿ®Ÿäÿπ</h2>
                <div class="controls">
                    <input type="text" id="newWeekName" placeholderÊûÅÈÄüÂø´3
                    <input type="date" id="newWeekStart">
                    <input type="date" id="newWeekEnd">
                    <button class="btn btn-primary" id="addWeekBtn">
                        <i class="fas fa-plus"></i> ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿ≥ÿ®Ÿàÿπ
                    </button>
                </div>
                <table id="weeksTable">
                    <thead>
                        <tr>
                            <thÊûÅÈÄüÂø´3
                            <th>ÿßÿ≥ŸÖ ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ</ÊûÅÈÄüÂø´3
                            <th>ŸÖŸÜ</th>
                            <th>ÿ•ŸÑŸâ</th>
                            <th>ÿ™ÿπÿØŸäŸÑ</th>
                            <th>ÿ≠ÿ∞ŸÅ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ -->
                    </tbody>
                </table>
            </div>

            <div class="tab-content" id="attendance">
                <h2>ÿ•ÿØÿßÿ±ÿ© ÿ™ÿ≥ÿ¨ŸäŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±</h2>
                <div class="controls">
                    <label>ÿßÿÆÿ™ÿ± ÿ£ÿ≥ÿ®Ÿàÿπ: </label>
                    <select id="deleteWeekSelect">
                        <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ -->
                    </select>
                    <button class="btn btn-danger" id="deleteAttendanceBtn">
                        <i class="fas fa-trash"></i> ÿ≠ÿ∞ŸÅ ŸÉŸÑ ÿ≠ÿ∂Ÿàÿ± Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ
                    </button>
                </div>
                <table id="attendanceTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>ÿßŸÑÿπÿ∂Ÿà</th>
                            <th>ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ</th>
                            <th>ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ</th>
                            <th>ÿ≠ÿ∞ŸÅ</th>
                        </tr>
                    </thead>
                    <tbody id="attendanceRecordsBody">
                        <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ§Ÿáÿß ÿ®ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ -->
                    </tbody>
                </table>
            </div>

            <div class="tab-content" id="reports">
                <h2>ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± ŸàÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™</h2>
                
                <div class="export-buttons">
                    <button class="btnÊûÅÈÄüÂø´3
                        <i class="fas fa-print"></i> ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±
                    </button>
                    <button class="btn btn-success" id="exportExcelBtn">
                        <i class="fas fa-file-excel"></i> ÿ™ÿµÿØŸäÿ± ŸÑÿ•ŸÉÿ≥ŸÑ
                    </button>
                </div>
                
                <div class="report-section">
                    <h3>üìä ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿπÿßŸÖÿ©</h3>
                    <div class="card-container">
                        <div class="summary-card">
                            <h3ÊûÅÈÄüÂø´3
                            <div class="summary-value" id="reportAttendance">0</div>
                            <div class="summary-subtitle">ÿ≠ÿ∂Ÿàÿ± ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≥ÿßÿ®Ÿäÿπ</div>
                        </div>
                        <div class="summary-card">
                            <h3>ÿßŸÑŸÜŸÇÿßÿ∑ ÿßŸÑŸÖŸÖŸÜŸàÿ≠ÿ©</h3>
                            <div class="summary-value" id="reportPoints">0</div>
                            <div class="summary-subtitle">ŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÜŸÇÿßÿ∑</div>
                        </div>
                        <div class="summary-card">
                            <h3>ÿπÿØÿØ ÿßŸÑÿ£ÿπÿ∂ÿßÿ°</h3>
                            <div class="summary-value" id="reportMembers">0</div>
                            <div class="summary-subtitle">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ£ÿπÿ∂ÿßÿ° ÿßŸÑŸÖÿ≥ÿ¨ŸÑŸäŸÜ</div>
                        </div>
                        <div class="summary-card">
                            <h3>ÿπÿØÿØ ÿßŸÑÿ£ÿ≥ÿßÿ®Ÿäÿπ</h3>
                            <div class="summary-value" id="reportWeeks">0</div>
                            <div class="summary-subtitle">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ£ÿ≥ÿßÿ®Ÿäÿπ</div>
                        </div>
                    </div>
                </div>

                <div class="report-section">
                    <h3>üèÜ ÿßŸÑŸÄ 10 ÿßŸÑÿ£Ÿàÿßÿ¶ŸÑ ŸÅŸä ÿßŸÑÿ≠ÿ∂Ÿàÿ±</h3>
                    <div class="top-members-list" id="topMembersList">
                        <p>ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...</p>
                    </div>
                </div>

                <div class="report-section">
                    <h3>üìà ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÑŸÑÿ£ÿ≥ÿ®Ÿàÿπ ÿßŸÑÿ≠ÿßŸÑŸä</h3>
                    <canvas id="attendanceChart" style="margin-top:20px;max-height:300px;"></canvas>
                </div>
            </div>
        </div>

        <!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ -->
        <div class="modal" id="adminLoginModal">
            <div class="modal-content">
                <h2>ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿßŸÑÿ£ÿØŸÖŸÜ</h2>
                <input type="password" id="adminPassword" placeholder="ŸÉŸÑŸÖÿ© ÿßŸÑÿ≥ÿ±">
                <div class="controls">
                    <button class="btn btn-danger" id="cancelAdminLogin">ÿ•ŸÑÿ∫ÿßÿ°</button>
                    <button class="btn btn-success" id="confirmAdminLogin">ÿØÿÆŸàŸÑ</button>
                </div>
            </div>
        </div>

        <!-- ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ -->
        <div class="notification" id="notification"></div>
    </div>

    <script>
    // ====== ÿ•ÿπÿØÿßÿØÿßÿ™ Firebase - Ÿäÿ¨ÿ® ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑŸáÿß ÿ®ÿ•ÿπÿØÿßÿØÿßÿ™ŸÉ ======
    const firebaseConfig = {
        apiKey: "AIzaSyBCQIqdCsxSvhfÊûÅÈÄüÂø´3
        authDomain: "angels-attendance.firebaseapp.com",
        databaseURL: "https://angels-attendance-default-rtdb.firebaseio.com",
        projectId: "angels-attendance",
        storageBucket: "angels-attendance.firebasestorage.app",
        messagingSenderId: "157249026489",
        appId: "1:157249026489:web:db2b420203bd81d9a19e68"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
    let members = [];
    let weeks = [];
    let attendanceRecords = [];
    let isAdmin = false;
    const adminPass = 'admin123';
    
    // Ÿàÿ∏ÿßÿ¶ŸÅ Firebase
    function showLoading() {
        document.getElementById('loading').style.display = 'block';
    }

    function hideLoading() {
        document.getElementById('loading').style.display = 'none';
    }

    function showNotification(message, isSuccess = true) {
        const notification = document.getElementById('notification');
        notification.textContent = message;
        notification.style.background = isSuccess ? '#2ecc71' : '#e74c3c';
        notification.style.display = 'block';
        
        setTimeout(() => {
            notification.style.display = 'none';
        }, 3000);
    }

    function loadData() {
        showLoading();
        const dataRef = database.ref('angelsAttendance');
        
        dataRef.on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) {
                members = data.members || [];
                weeks = data.weeks || [];
                attendanceRecords = data.attendanceRecords || [];
            } else {
                // ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ£ŸàŸÑŸäÿ© ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™
                members = [
                    {id: 1, name: 'üßí Mary Karam', image: 'https://ui-avatars.com/api/?name=Mary+Karam&background=3498db&color=fff'},
                    {id: 2, name: 'üë¶ Eman Makin', image: 'https://ui-avatars.com/api/?name=Eman+Makin&background=2ecc71&color=fff'},
                    {id: 3, name: 'üëß Rizk Gerges', image: 'https://ui-avatarsÊûÅÈÄüÂø´3
                ];
                weeks = [
                    {id: 1, name: 'ÿßŸÑÿßÿ≥ÿ®Ÿàÿπ ÿßŸÑÿßŸàŸÑ', from: '2023-08-01', to: '2023-08-07'},
                    {id: 2, name: 'ÿßŸÑÿßÿ≥ÿ®Ÿàÿπ ÿßŸÑÿ´ÿßŸÜŸä', from: '2023-08-08', to: '2023-08-14'}
                ];
                attendanceRecords = [];
                saveData();
            }
            populateData();
            updateReports();
            hideLoading();
        }, (error) => {
            console.error('Error loading data:', error);
            hideLoading();
            alert('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™. ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßÿ™ÿµÿßŸÑ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™.');
        });
    }

    function saveData() {
        showLoading();
        const dataRef = database.ref('angelsAttendance');
        dataRef.set({
            members: members,
            weeks: weeks,
            attendanceRecords: attendanceRecords
        }).then(() => {
            hideLoading();
        }).catch((error) => {
            console.error('Error saving data:', error);
            hideLoading();
            alert('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™. ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßÿ™ÿµÿßŸÑ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™.');
        });
    }
    
    // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
    function initApp() {
        setupEventListeners();
        loadData();
    }
    
    // ÿ•ÿπÿØÿßÿØ ŸÖÿ≥ÿ™ŸÖÿπŸä ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
    function setupEventListeners() {
        // ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
        document.getElementById('markPresent').addEventListener('click', markAttendance);
        
        // ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿßŸÑÿ£ÿØŸÖŸÜ
        document.getElementById('adminLoginBtn').addEventListener('click', showAdminLogin);
        document.getElementById('cancelAdminLogin').addEventListener('click', hideAdminLogin);
        document.getElementById('confirmAdminLogin').addEventListener('click', confirmAdminLogin);
        
        // ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨
        document.getElementById('logoutBtn').addEventListener('click', logout);
        
        // ÿßŸÑÿ™ÿ®ŸàŸäÿ®ÿßÿ™
        document.querySelectorAll('#mainÊûÅÈÄüÂø´3
            tab.addEventListener('click', () => {
                const tabId = tab.dataset.tab;
                activateTab(tabId);
            });
        });
        
        // ÿ•ÿ∂ÿßŸÅÿ© ÿπÿ∂Ÿà
        document.getElementById('addMemberBtn').addEventListener('click', addNewMember);
        
        // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿ≥ÿ®Ÿàÿπ
        document.getElementById('addWeekBtn').addEventListener('click', addNewWeek);
        
        // ÿ≠ÿ∞ŸÅ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
        document.getElementById('deleteAttendanceBtn').addEventListener('click', deleteAllWeekAttendance);
        
        // ÿßŸÑÿ™ÿµÿØŸäÿ± ŸàÿßŸÑÿ∑ÿ®ÿßÿπÿ©
        document.getElementById('printReportBtn').addEventListener('click', printReport);
        document.getElementById('exportExcelBtn').addEventListener('click', exportToExcel);
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿπŸÜÿØ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ
        document.getElementById('weekSelect').addEventListener('change', updateAttendanceStats);
    }
    
    // ÿ™ÿπÿ®ÿ¶ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸä ÿßŸÑÿ¨ÿØÿßŸàŸÑ
    function populateData() {
        const selectMember = document.getElementById('selectMember');
        selectMember.innerHTML = '';
        members.forEach(m => {
            let option = document.createElement('option');
            option.value = m.id;
            option.textContent = m.name;
            selectMember.appendChild(option);
        });

        const weekSelect = document.getElementById('weekSelect');
        weekSelect.innerHTML = '';
        weeks.forEach(w => {
            let option = document.createElement('option');
            option.value = w.id;
            option.textContent = w.name;
            weekSelect.appendChild(option);
        });

        // ÿ™ÿπÿ®ÿ¶ÿ© ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ£ÿ≥ÿßÿ®Ÿäÿπ ŸÅŸä ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ≠ÿ∂Ÿàÿ±
        const deleteWeekSelect = document.getElementById('deleteWeekSelect');
        deleteWeekSelect.innerHTML = '';
        weeks.forEach(w => {
            let option = document.createElement('option');
            option.value = w.id;
            option.textContent = w.name;
            deleteWeekSelect.appendChild(option);
        });

        // ÿ™ÿπÿ®ÿ¶ÿ© ÿ¨ÿØŸàŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
        const tbody = document.getElementById('attendanceTableBody');
        tbody.innerHTML = '';
        
        const selectedWeekId = document.getElementById('weekSelect').value;
        const selectedWeek = weeks.find(w => w.id == selectedWeekId);
        
        members.forEach((m, i) => {
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ÿ≥ÿ¨ŸÑ ÿ≠ÿ∂Ÿàÿ± ŸÑŸáÿ∞ÿß ÿßŸÑÿπÿ∂Ÿà ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ
            const attendanceRecord = attendanceRecords.find(ar => 
                ar.memberId === m.id && ar.weekId == selectedÊûÅÈÄüÂø´3
            );
            
            const isPresent = attendanceRecord ? attendanceRecord.present : false;
            
            let tr = document.createElement('tr');
            tr.dataset.member = m.id;
            tr.innerHTML = `
                <td>${i+1}</td>
                <td><img src="${m.image || 'https://ui-avatars.com/api/?name=Member&background=ccc&color=fff'}" class="member-img" alt="${m.name}"></td>
                <td>${m.name}</td>
                <td>${selectedWeek ? selectedWeek.name : ''}</td>
                <td class="attendance-value">${isPresent ? '1' : '0ÊûÅÈÄüÂø´3
                <td class="points">${isPresent ? '1' : '0'}</td>
            `;
            tbody.appendChild(tr);
        });
        
        document.getElementById('totalMembers').textContent = members.length;
        updateAttendanceStats();
        populateAdminTables();
        populateAttendanceRecords();
        updateReports();
    }
    
    // ÿ™ÿπÿ®ÿ¶ÿ© ÿßŸÑÿ¨ÿØÿßŸàŸÑ ÿßŸÑÿ•ÿØÿßÿ±Ÿäÿ©
    function populateAdminTables() {
        const membersTbody = document.querySelector('#membersTable tbody');
        membersÊûÅÈÄüÂø´3
        members.forEach((m, i) => {
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÜŸÇÿßÿ∑ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ© ŸÑŸÉŸÑ ÿπÿ∂Ÿà
            const totalPoints = attendanceRecords.filter(ar => 
                ar.memberId === m.id && ar.present
            ).length;
            
            let tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${i+1}</td>
                <td><img src="${m.image || 'https://ui-avatars.com/api/?name=Member&background=ccc&color=fff'}" class="member-img" alt="${m.name}"></ÊûÅÈÄüÂø´3
                <td>${m.name}</td>
                <td>${totalPoints}</ÊûÅÈÄüÂø´3
                <td><button class='btn btn-primary editMember' data-id='${m.id}'>ÿ™ÿπÿØŸäŸÑ</button></td>
                <td><button class='btn btn-danger deleteMember' data-id='${m.id}'>ÿ≠ÿ∞ŸÅ</button></td>
            `;
            membersTbody.appendChild(tr);
        });
        
        const weeksTbody = document.querySelector('#weeksTable tbody');
        weeksTbody.innerHTML = '';
        weeks.forEach((w, i) => {
            let tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${i+1}</td>
                <td>${w.name}</td>
                <td>${w.from}</td>
                <td>${w.to}</td>
                <td><button class='btn btn-primary editWeek' data-id='${w.id}'>ÿ™ÿπÿØŸäŸÑ</button></td>
                <td><button class='btn btn-danger deleteWeek' data-id='${w.id}'>ÿ≠ÿ∞ŸÅ</button></td>
            `;
            weeksTbody.appendChild(tr);
        });
        
        // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ŸÖÿπŸä ÿßŸÑÿ£ÿ≠ÿØÿßÿ´ ŸÑŸÑÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ©
        attachEditDeleteListeners();
    }
    
    // ÿπÿ±ÿ∂ ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
    function populateAttendanceRecords() {
        const tbody = document.querySelector('#attendanceRecordsBody');
        tbody.innerHTML = '';
        
        attendanceRecords.forEach((record, index) => {
            const member = members.find(m => m.id === record.memberId);
            const week = weeks.find(w => w.id == record.weekId);
            
            if (member && week) {
                let tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${member.name}</td>
                    <td>${week.name}</td>
                    <td>${new Date(record.date).toLocaleString('ar-EG')}</td>
                    <td><button class='btn btn-danger deleteAttendance' data-index='${index}'>ÿ≠ÿ∞ŸÅ</button></td>
                `;
                tbody.appendChild(tr);
            }
        });
        
        // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ŸÖÿπŸä ÿßŸÑÿ£ÿ≠ÿØÿßÿ´ ŸÑÿ£ÿ≤ÿ±ÿßÿ± ÿ≠ÿ∞ŸÅ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
        document.querySelectorAll('.deleteAttendance').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const index = parseInt(e.target.dataset.index);
                deleteAttendanceRecord(index);
            });
        });
    }
    
    // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ŸÖÿπŸä ÿßŸÑÿ£ÿ≠ÿØÿßÿ´ ŸÑÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿπÿØŸäŸÑ ŸàÿßŸÑÿ≠ÿ∞ŸÅ
    function attachEditDeleteListeners() {
        // ÿ™ÿπÿØŸäŸÑ Ÿàÿ≠ÿ∞ŸÅ ÿ£ÿπÿ∂ÿßÿ°
        document.querySelectorAll('.editMember').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const memberId = parseInt(e.target.dataset.id);
                const member = members.find(m => m.id === memberId);
                const index = members.findIndex(m => m.id === memberId);
                
                const newName = prompt('ÿπÿØŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿπÿ∂Ÿà:', member.name);
                const newImage = prompt('ÿπÿØŸÑ ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿµŸàÿ±ÿ© (ÿßÿ™ÿ±ŸÉŸá ŸÅÿßÿ±ÿ∫ÿßŸã ÿ•ÿ∞ÿß ŸÑÿß ÿ™ÿ±ŸäÿØ ÿ™ÿ∫ŸäŸäÿ±Ÿá):', member.image);
                if (newName) {
                    members[index].name = newName;
                    if (newImage) members[index].image = newImage;
                    saveData();
                    showNotification('ÿ™ŸÖ ÿ™ÿπÿØŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿπÿ∂Ÿà ÿ®ŸÜÿ¨ÿßÿ≠');
                }
            });
        });
        
        document.querySelectorAll('.deleteMember').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const memberId = parseInt(e.target.dataset.id);
                const member = members.findÊûÅÈÄüÂø´3
                
                if (confirm(`ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ ÿßŸÑÿπÿ∂Ÿà ${member.name}ÿü`)) {
                    // ÿ≠ÿ∞ŸÅ ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ÿßŸÑÿÆÿßÿµÿ© ÿ®Ÿáÿ∞ÿß ÿßŸÑÿπÿ∂Ÿà ÿ£ŸàŸÑÿßŸã
                    attendanceRecords = attendanceRecords.filter(ar => ar.memberId !== memberId);
                    
                    members = members.filter(m => m.id !== memberId);
                    saveData();
                    showNotification('ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿπÿ∂Ÿà ÿ®ŸÜÿ¨ÿßÿ≠');
                }
            });
        });
        
        // ÿ™ÿπÿØŸäŸÑ Ÿàÿ≠ÿ∞ŸÅ ÿ£ÿ≥ÿßÿ®Ÿäÿπ
        document.querySelectorAll('.editWeek').forEach(btn => {
            btn.addEventListener('click', (ÊûÅÈÄüÂø´3
                const weekId = parseInt(e.target.dataset.id);
                const week = weeks.find(w => w.id === weekId);
                const index = weeks.findIndex(w => w.id === weekId);
                
                const newName = prompt('ÿπÿØŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ:', week.name);
                const newFrom = prompt('ÿπÿØŸÑ ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ®ÿØÿßŸäÿ©:', week.from);
                const newTo = prompt('ÿπÿØŸÑ ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑŸÜŸáÿßŸäÿ©:', week.to);
                if (newName && newFrom && newTo) {
                    weeks[index] = {...weeks[index], name: newName, from: newFrom, to: newTo};
                    saveData();
                    showNotification('ÿ™ŸÖ ÿ™ÿπÿØŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ ÿ®ŸÜÿ¨ÿßÿ≠');
                }
            });
        });
        
        document.querySelectorAll('.deleteWeek').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const weekId = parseInt(e.target.dataset.id);
                const week = weeks.find(w => w.id === weekId);
                
                if (confirm(`ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ ${week.name}ÿü`)) {
                    // ÿ≠ÿ∞ŸÅ ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ÿßŸÑÿÆÿßÿµÿ© ÿ®Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ ÿ£ŸàŸÑÿßŸã
                    attendanceRecords = attendanceRecords.filter(ar => ar.weekId != weekId);
                    
                    weeks = weeks.filter(w => w.id !== weekId);
                    saveData();
                    showNotification('ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ ÿ®ŸÜÿ¨ÿßÿ≠');
                }
            });
        });
    }
    
    // ÿ™ŸÅÿπŸäŸÑ ÿ™ÿ®ŸàŸäÿ®
    function activateTab(tabId) {
        // ÿ•ÿÆŸÅÿßÿ° ŸÉŸÑ ÿßŸÑŸÖÿ≠ÿ™ŸàŸäÿßÿ™
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
        });
        
        // ÿ•ŸÑÿ∫ÿßÿ° ÿ™ŸÅÿπŸäŸÑ ŸÉŸÑ ÿßŸÑÿ£ŸÑÿ≥ŸÜÿ©
        document.querySelectorAll('#mainTabs .tab').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ™ÿ®ŸàŸäÿ® ÿßŸÑŸÖÿ≠ÿØÿØ
        document.getElementById(tabId).classList.add('active');
        document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
        
        // ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿ™ÿ®ŸàŸäÿ® ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±ÿå ŸÇŸÖ ÿ®ÿ™ÿ≠ÿØŸäÿ´Ÿáÿß
        if (tabId === 'reports') {
            updateReports();
        }
    }
    
    // ÿ™ÿ≠ÿØŸäÿ´ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
    function updateAttendanceStats() {
        const selectedWeekId = document.getElementById('weekSelect').value;
        let count = 0;
        
        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÑŸáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ ŸÅŸÇÿ∑
        const weekAttendance = attendanceRecords.filter(ar => 
            ar.weekId == selectedWeekId && ar.present
        );
        
        count = weekAttendance.length;
        
        document.getElementById('attendanceCount').textContent = count;
        document.getElementById('totalPoints').textContent = count;
        updateChart();
    }
    
    // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ±
    function updateReports() {
        // ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿπÿßŸÖÿ©
        const totalAttendance = attendanceRecords.filter(ar => ar.present).length;
        
        document.getElementById('reportAttendance').textContent = totalAttendance;
        document.getElementById('reportPoints').textContent = totalAttendance;
        document.getElementById('reportMembers').textContent = members.length;
        document.getElementById('reportWeeks').textContent = weeks.length;
        
        // ÿßŸÑŸÄ 10 ÿßŸÑÿ£Ÿàÿßÿ¶ŸÑ
        updateTopMembers();
    }
    
    // ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÄ 10 ÿßŸÑÿ£Ÿàÿßÿ¶ŸÑ
    function updateTopMembers() {
        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÜŸÇÿßÿ∑ ŸÑŸÉŸÑ ÿπÿ∂Ÿà
        const memberPoints = members.map(member => {
            const points = attendanceRecords.filter(ar => 
                ar.memberId === member.id && ar.present
            ).length;
            return { name: member.name, points: points, image: member.image };
        });
        
        // ÿ™ÿ±ÿ™Ÿäÿ® ÿ™ŸÜÿßÿ≤ŸÑŸä ÿ≠ÿ≥ÿ® ÿßŸÑŸÜŸÇÿßÿ∑
        memberPoints.sort((a, bÊûÅÈÄüÂø´3
        // ÿ£ÿÆÿ∞ ÿ£ŸàŸÑ 10 ŸÅŸÇÿ∑
        const top10 = memberPoints.slice(0, 10);
        
        // ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
        const topMembersList = document.getElementById('topMembersList');
        topMembersList.innerHTML = '';
        
        if (top10.length === 0) {
            topMembersList.innerHTML = '<ÊûÅÈÄüÂø´3
            return;
        }
        
        top10.forEach((member, index) => {
            const item = document.createElement('div');
            item.className = 'top-member-item';
            
            let medal = '';
            if (index === 0) medal = '<span class="medal medal-gold">ü•á</span>';
            else if (index === 1) medal = '<span class="medal medal-silver">ü•à</span>';
            else if (index === 2) medal = '<span class="medal medal-bronze">ü•â</span>';
            
            item.innerHTML = `
                <div style="display:flex;align-items:center;gap:10px;">
                    <img src="${member.image || 'https://ui-avatars.com/api/?name=Member&background=ccc&color=fff'}" class="member-img" alt="${member.name}">
                    <div class="top-member-name">${medal} ${member.name}</div>
                </div>
                <div class="top-member-points">${member.points} ŸÜŸÇÿ∑ÿ©</div>
            `;
            topMembersList.appendChild(item);
        });
    }
    
    // ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÑŸÑÿπÿ∂Ÿà ÿßŸÑŸÖÿ≠ÿØÿØ
    function markAttendance() {
        const memberId = parseInt(document.getElementById('selectMember').value);
        const weekId = parseInt(document.getElementById('weekSelect').value);
        
        if (!memberId || !weekId) {
            alert('Ÿäÿ¨ÿ® ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿπÿ∂Ÿà ŸàÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ ÿ£ŸàŸÑÿßŸã');
            return;
        }
        
        const index = attendanceRecords.findIndex(ar => 
            ar.memberId === memberId && ar.weekId == weekId
        );
        
        if (index !== -1) {
            showNotification('ŸÑŸÇÿØ ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ≠ÿ∂Ÿàÿ± Ÿáÿ∞ÿß ÿßŸÑÿπÿ∂Ÿà already ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ', false);
        } else {
            // ÿ•ÿ∂ÿßŸÅÿ© ÿ≥ÿ¨ŸÑ ÿ¨ÿØŸäÿØ
            attendanceRecords.push({
                memberÊûÅÈÄüÂø´3
                weekId: weekId,
                present: true,
                date: new Date().toISOString()
            });
            
            saveData();
            showNotification('ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ÿ®ŸÜÿ¨ÿßÿ≠!', true);
        }
    }
    
    // ÿ•ÿ∂ÿßŸÅÿ© ÿπÿ∂Ÿà ÿ¨ÿØŸäÿØ
    function addNewMember() {
        const name = document.getElementById('newMemberName').value;
        const image = document.getElementById('newMemberImage').value;
        
        if (!name) {
            alert('ÿßÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿπÿ∂Ÿà');
            return;
        }
        
        const id = members.length ? Math.max(...members.map(m => m.id)) + 1 : 1;
        members.push({
            id,
            name,
            image: image || `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=3498db&color=fff`
        });
        
        saveData();
        showNotification('ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿπÿ∂Ÿà ÿ®ŸÜÿ¨ÿßÿ≠');
        
        // ŸÖÿ≥ÿ≠ ÿßŸÑÿ≠ŸÇŸàŸÑ
        document.getElementById('newMemberName').value = '';
        document.getElementById('newMemberImage').value = '';
    }
    
    // ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿ≥ÿ®Ÿàÿπ ÿ¨ÿØŸäÿØ
    function addNewWeek() {
        const name = document.getElementById('newWeekName').value;
        const from = document.getElementById('newWeekStart').value;
        const to = document.getElementById('newWeekEnd').value;
        
        if (!name || !from || !ÊûÅÈÄüÂø´3
            alert('ÿßŸÖŸÑÿ£ ŸÉŸÑ ÿßŸÑÿ≠ŸÇŸàŸÑ');
            return;
        }
        
        const id = weeks.length ? Math.max(...weeks.map(w => w.id)) + 1 : 1;
        weeks.push({ id, name, from, to });
        
        saveData();
        showNotification('ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ ÿ®ŸÜÿ¨ÿßÿ≠');
        
        // ŸÖÿ≥ÿ≠ ÿßŸÑÿ≠ŸÇŸàŸÑ
        document.getElementById('newWeekName').value = '';
        document.getElementById('newWeekStart').value = '';
        document.getElementById('newWeekEnd').value = '';
    }
    
    // ÿ≠ÿ∞ŸÅ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ≠ÿ∂Ÿàÿ± ŸÖÿ≠ÿØÿØ
    function deleteAttendanceRecord(index) {
        if (confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± Ÿáÿ∞ÿßÿü')) {
            attendanceRecords.splice(index, 1);
            saveData();
            showNotification('ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ±');
        }
    }
    
    // ÿ≠ÿ∞ŸÅ ŸÉŸÑ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÑÿ£ÿ≥ÿ®Ÿàÿπ ŸÖÿ≠ÿØÿØ
    function deleteAllWeekAttendance() {
        const weekId = parseInt(document.getElementById('deleteWeekSelect').value);
        
        if (!weekId) {
            alert('Ÿäÿ¨ÿ® ÿßÿÆÿ™Ÿäÿßÿ± ÿ£ÿ≥ÿ®Ÿàÿπ ÿ£ŸàŸÑÿßŸã');
            return;
        }
        
        if (confirm(`ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ ŸÉŸÑ ÿ™ÿ≥ÿ¨ŸäŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÑŸÑÿ£ÿ≥ÿ®Ÿàÿπ ÿßŸÑŸÖÿ≠ÿØÿØÿü Ÿáÿ∞ÿß ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ° ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜŸá!`)) {
            attendanceRecords = attendanceRecords.filter(ar => ar.weekId != weekId);
            saveData();
            showNotification('ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿ™ÿ≥ÿ¨ŸäŸÑÿßÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÑŸáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ');
        }
    }
    
    // ÿπÿ±ÿ∂ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿßŸÑÿ£ÿØŸÖŸÜ
    function showAdminLogin() {
        document.getElementById('adminLoginModal').style.display = 'flex';
    }
    
    // ÿ•ÿÆŸÅÿßÿ° ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿßŸÑÿ£ÿØŸÖŸÜ
    function hideAdminLogin() {
        document.getElementById('adminLoginModal').style.display = 'none';
    }
    
    // ÿ™ÿ£ŸÉŸäÿØ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿßŸÑÿ£ÿØŸÖŸÜ
    function confirmAdminLogin() {
        const pwd = document.getElementById('adminPassword').value;
        if (pwd === adminPass) {
            isAdmin = true;
            document.getElementById('adminLoginModal').style.display = 'none';
            document.getElementById('adminSection').ÊûÅÈÄüÂø´3
            document.getElementById('adminLoginBtn').style.display = 'none';
            showNotification('ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÉŸÖÿ≥ÿ§ŸàŸÑ');
        } else {
            alert('ŸÉŸÑŸÖÿ© ÿßŸÑÿ≥ÿ± ÿÆÿ∑ÿ£!');
        }
    }
    
    // ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨
    function logout() {
        isAdmin = false;
        document.getElementById('adminSection').style.display = 'none';
        document.getElementById('adminLoginBtn').style.display = 'block';
        showNotification('ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨');
    }
    
    // ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±
    function printReport() {
        window.print();
    }
    
    // ÿ™ÿµÿØŸäÿ± ŸÑÿ•ŸÉÿ≥ŸÑ
    function exportToExcel() {
        showNotification('ÿ™ŸÖ ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ•ŸÑŸâ Excel');
    }
    
    // ÿßŸÑÿ±ÿ≥ŸÖ ÿßŸÑÿ®ŸäÿßŸÜŸä
    const ctx = document.getElementById('attendanceChart').getContext('2d');
    let chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [],
            datasets: [{
                label: 'ÿßŸÑÿ≠ÿ∂Ÿàÿ±',
                data: [],
                backgroundColor: ['#3498db', '#2ecc71', '#f39c12', '#9b59b6', '#e74c3c', '#1abc9c', '#34495e', '#f1c40f', '#d35400', '#7f8c8d']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: false
                },
                title: {
                    display: true,
                    text: 'ÿ≠ÿ∂Ÿàÿ± ÿßŸÑÿ£ÿπÿ∂ÿßÿ° ŸÑŸáÿ∞ÿß ÿßŸÑÿ£ÿ≥ÿ®Ÿàÿπ',
                    font: {
                        size: 16
                    }
                }
            },
            scales: {
                yÊûÅÈÄüÂø´3
                    beginAtZero: true,
                    max: 1,
                    ticks: {
                        stepÊûÅÈÄüÂø´3
                    }
                }
            }
        }
    });
    
    function updateChart() {
        const selectedWeekId = document.getElementById('weekSelect').value;
        
        const data = members.map(member => {
            const record = attendanceRecords.find(ar => 
                ar.memberId === member.id && ar.weekId == selectedWeekId
            );
            return record && record.present ? 1 : 0;
        });
        
        chart.data.labels = members.map(m => m.name);
        chart.data.datasets[0].data = data;
        chart.update();
    }
    
    // ÿ®ÿØÿ° ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿπŸÜÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
    window.addEventListener('load', initApp);
    </script>
</body>
</html>
