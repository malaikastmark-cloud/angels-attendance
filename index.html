===== index.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>تسجيل الحضور - Talanton</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>تسجيل الحضور</h1>
  <form id="attendanceForm">
    <label>اختر اسمك:</label>
    <select id="memberSelect"></select>

    <label>اختر الأسبوع:</label>
    <select id="weekSelect"></select>

    <button type="submit">تسجيل الحضور</button>
  </form>

  <script type="module" src="app.js"></script>
</body>
</html>

===== style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #f9f9f9;
  padding: 20px;
}

form {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  max-width: 400px;
  margin: auto;
}

label, select, button {
  display: block;
  margin-bottom: 15px;
  width: 100%;
}

===== firebase-config.js =====
import { initializeApp } from "firebase/app";
import { getDatabase } from "firebase/database";

const firebaseConfig = {
  apiKey: "AIzaSyBCQIqdCsxSvhfYOs00AetoVWpFhj4XNAQ",
  authDomain: "angels-attendance.firebaseapp.com",
  databaseURL: "https://angels-attendance-default-rtdb.firebaseio.com",
  projectId: "angels-attendance",
  storageBucket: "angels-attendance.firebasestorage.app",
  messagingSenderId: "157249026489",
  appId: "1:157249026489:web:db2b420203bd81d9a19e68",
  measurementId: "G-2YDPSFPQYT"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

export { db };

===== app.js =====
import { db } from './firebase-config.js';
import { ref, onValue, push } from "firebase/database";

const memberSelect = document.getElementById("memberSelect");
const weekSelect = document.getElementById("weekSelect");
const form = document.getElementById("attendanceForm");

// تحميل الأعضاء
onValue(ref(db, 'members'), snapshot => {
  memberSelect.innerHTML = '';
  snapshot.forEach(child => {
    const option = document.createElement("option");
    option.value = child.key;
    option.textContent = child.val().name;
    memberSelect.appendChild(option);
  });
});

// تحميل الأسابيع
onValue(ref(db, 'weeks'), snapshot => {
  weekSelect.innerHTML = '';
  snapshot.forEach(child => {
    const option = document.createElement("option");
    option.value = child.key;
    option.textContent = child.val().name;
    weekSelect.appendChild(option);
  });
});

// تسجيل الحضور
form.addEventListener("submit", e => {
  e.preventDefault();
  const memberId = memberSelect.value;
  const weekId = weekSelect.value;

  push(ref(db, 'attendance'), {
    memberId,
    weekId,
    timestamp: Date.now(),
    talanton: 1
  });

  alert("تم تسجيل الحضور!");
});
===== admin.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>لوحة تحكم الأدمن - Talanton</title>
  <link rel="stylesheet" href="admin-style.css">
</head>
<body>
  <h1>لوحة تحكم الأدمن</h1>

  <section>
    <h2>إدارة الأعضاء</h2>
    <form id="addMemberForm">
      <input type="text" id="memberName" placeholder="اسم العضو">
      <button type="submit">إضافة عضو</button>
    </form>
    <ul id="memberList"></ul>
  </section>

  <section>
    <h2>إدارة الأسابيع</h2>
    <form id="addWeekForm">
      <input type="text" id="weekName" placeholder="اسم الأسبوع">
      <button type="submit">إضافة أسبوع</button>
    </form>
    <ul id="weekList"></ul>
  </section>

  <script type="module" src="admin-app.js"></script>
</body>
</html>

===== admin-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #eef;
  padding: 20px;
}

section {
  background: #fff;
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 8px;
}

input, button {
  display: block;
  margin-bottom: 10px;
  width: 100%;
  padding: 8px;
}

ul {
  list-style: none;
  padding: 0;
}

li {
  background: #f0f0f0;
  margin-bottom: 5px;
  padding: 10px;
  border-radius: 4px;
}

===== admin-app.js =====
import { db } from './firebase-config.js';
import { ref, push, onValue } from "firebase/database";

// إضافة عضو
const addMemberForm = document.getElementById("addMemberForm");
const memberNameInput = document.getElementById("memberName");
const memberList = document.getElementById("memberList");

addMemberForm.addEventListener("submit", e => {
  e.preventDefault();
  const name = memberNameInput.value.trim();
  if (name) {
    push(ref(db, 'members'), { name });
    memberNameInput.value = '';
  }
});

// عرض الأعضاء
onValue(ref(db, 'members'), snapshot => {
  memberList.innerHTML = '';
  snapshot.forEach(child => {
    const li = document.createElement("li");
    li.textContent = child.val().name;
    memberList.appendChild(li);
  });
});

// إضافة أسبوع
const addWeekForm = document.getElementById("addWeekForm");
const weekNameInput = document.getElementById("weekName");
const weekList = document.getElementById("weekList");

addWeekForm.addEventListener("submit", e => {
  e.preventDefault();
  const name = weekNameInput.value.trim();
  if (name) {
    push(ref(db, 'weeks'), { name });
    weekNameInput.value = '';
  }
});

// عرض الأسابيع
onValue(ref(db, 'weeks'), snapshot => {
  weekList.innerHTML = '';
  snapshot.forEach(child => {
    const li = document.createElement("li");
    li.textContent = child.val().name;
    weekList.appendChild(li);
  });
});
===== admin-extended.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>إدارة الحضور والمتجر والتقارير - Talanton</title>
  <link rel="stylesheet" href="admin-extended-style.css">
</head>
<body>
  <h1>إدارة الحضور والمتجر والتقارير</h1>

  <section>
    <h2>سجل الحضور</h2>
    <ul id="attendanceList"></ul>
  </section>

  <section>
    <h2>متجر Talanton</h2>
    <form id="addItemForm">
      <input type="text" id="itemName" placeholder="اسم العنصر">
      <input type="number" id="itemPrice" placeholder="السعر بـ Talanton">
      <button type="submit">إضافة عنصر</button>
    </form>
    <ul id="storeList"></ul>
  </section>

  <section>
    <h2>تقارير الأعضاء</h2>
    <ul id="reportList"></ul>
  </section>

  <script type="module" src="admin-extended-app.js"></script>
</body>
</html>

===== admin-extended-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #fdfdfd;
  padding: 20px;
}

section {
  background: #fff;
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 8px;
}

input, button {
  display: block;
  margin-bottom: 10px;
  width: 100%;
  padding: 8px;
}

ul {
  list-style: none;
  padding: 0;
}

li {
  background: #f0f0f0;
  margin-bottom: 5px;
  padding: 10px;
  border-radius: 4px;
}

===== admin-extended-app.js =====
import { db } from './firebase-config.js';
import { ref, push, onValue } from "firebase/database";

// عرض الحضور
const attendanceList = document.getElementById("attendanceList");
onValue(ref(db, 'attendance'), snapshot => {
  attendanceList.innerHTML = '';
  snapshot.forEach(child => {
    const data = child.val();
    const li = document.createElement("li");
    li.textContent = `عضو: ${data.memberId} | أسبوع: ${data.weekId} | نقاط: ${data.talanton}`;
    attendanceList.appendChild(li);
  });
});

// إضافة عنصر للمتجر
const addItemForm = document.getElementById("addItemForm");
const itemNameInput = document.getElementById("itemName");
const itemPriceInput = document.getElementById("itemPrice");
const storeList = document.getElementById("storeList");

addItemForm.addEventListener("submit", e => {
  e.preventDefault();
  const name = itemNameInput.value.trim();
  const price = parseInt(itemPriceInput.value);
  if (name && price > 0) {
    push(ref(db, 'store'), { name, price });
    itemNameInput.value = '';
    itemPriceInput.value = '';
  }
});

// عرض عناصر المتجر
onValue(ref(db, 'store'), snapshot => {
  storeList.innerHTML = '';
  snapshot.forEach(child => {
    const item = child.val();
    const li = document.createElement("li");
    li.textContent = `${item.name} - ${item.price} Talanton`;
    storeList.appendChild(li);
  });
});

// عرض تقارير الأعضاء
const reportList = document.getElementById("reportList");
onValue(ref(db, 'members'), snapshot => {
  reportList.innerHTML = '';
  snapshot.forEach(child => {
    const memberId = child.key;
    const memberName = child.val().name;

    // حساب إجمالي Talanton
    let totalTalanton = 0;
    onValue(ref(db, 'attendance'), attendanceSnapshot => {
      attendanceSnapshot.forEach(att => {
        if (att.val().memberId === memberId) {
          totalTalanton += att.val().talanton;
        }
      });

      const li = document.createElement("li");
      li.textContent = `العضو: ${memberName} | إجمالي Talanton: ${totalTalanton}`;
      reportList.appendChild(li);
    }, { onlyOnce: true });
  });
});
===== admin-security.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>إعدادات الأمان - Talanton</title>
  <link rel="stylesheet" href="admin-security-style.css">
</head>
<body>
  <h1>إعدادات الأمان</h1>

  <section>
    <h2>تغيير كلمة سر الأدمن</h2>
    <form id="changePasswordForm">
      <input type="password" id="newPassword" placeholder="كلمة السر الجديدة">
      <button type="submit">تغيير</button>
    </form>
  </section>

  <section>
    <h2>سجل محاولات التسجيل</h2>
    <ul id="attemptLog"></ul>
  </section>

  <script type="module" src="admin-security-app.js"></script>
</body>
</html>

===== admin-security-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #fff8f0;
  padding: 20px;
}

section {
  background: #fff;
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 8px;
}

input, button {
  display: block;
  margin-bottom: 10px;
  width: 100%;
  padding: 8px;
}

ul {
  list-style: none;
  padding: 0;
}

li {
  background: #f0f0f0;
  margin-bottom: 5px;
  padding: 10px;
  border-radius: 4px;
}

===== admin-security-app.js =====
import { db } from './firebase-config.js';
import { ref, set, onValue, push } from "firebase/database";

// تغيير كلمة السر
const changePasswordForm = document.getElementById("changePasswordForm");
const newPasswordInput = document.getElementById("newPassword");

changePasswordForm.addEventListener("submit", e => {
  e.preventDefault();
  const newPassword = newPasswordInput.value.trim();
  if (newPassword.length >= 6) {
    set(ref(db, 'admin/password'), newPassword);
    alert("تم تغيير كلمة السر بنجاح");
    newPasswordInput.value = '';
  } else {
    alert("كلمة السر يجب أن تكون 6 أحرف أو أكثر");
  }
});

// عرض سجل المحاولات
const attemptLog = document.getElementById("attemptLog");

onValue(ref(db, 'loginAttempts'), snapshot => {
  attemptLog.innerHTML = '';
  snapshot.forEach(child => {
    const attempt = child.val();
    const li = document.createElement("li");
    li.textContent = `العضو: ${attempt.user} | التاريخ: ${new Date(attempt.timestamp).toLocaleString()} | الحالة: ${attempt.status}`;
    attemptLog.appendChild(li);
  });
});
===== admin-events.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>إدارة المناسبات والمهمات وأعياد الميلاد - Talanton</title>
  <link rel="stylesheet" href="admin-events-style.css">
</head>
<body>
  <h1>إدارة المناسبات والمهمات وأعياد الميلاد</h1>

  <section>
    <h2>إضافة مناسبة</h2>
    <form id="addEventForm">
      <input type="text" id="eventName" placeholder="اسم المناسبة">
      <input type="date" id="eventDate">
      <button type="submit">إضافة</button>
    </form>
    <ul id="eventList"></ul>
  </section>

  <section>
    <h2>إضافة مهمة</h2>
    <form id="addTaskForm">
      <input type="text" id="taskName" placeholder="اسم المهمة">
      <input type="text" id="taskOwner" placeholder="المسؤول">
      <input type="date" id="taskDeadline">
      <button type="submit">إضافة</button>
    </form>
    <ul id="taskList"></ul>
  </section>

  <section>
    <h2>أعياد الميلاد</h2>
    <form id="addBirthdayForm">
      <input type="text" id="birthdayName" placeholder="اسم العضو">
      <input type="date" id="birthdayDate">
      <button type="submit">إضافة</button>
    </form>
    <ul id="birthdayList"></ul>
  </section>

  <script type="module" src="admin-events-app.js"></script>
</body>
</html>

===== admin-events-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #f0fff0;
  padding: 20px;
}

section {
  background: #fff;
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 8px;
}

input, button {
  display: block;
  margin-bottom: 10px;
  width: 100%;
  padding: 8px;
}

ul {
  list-style: none;
  padding: 0;
}

li {
  background: #f0f0f0;
  margin-bottom: 5px;
  padding: 10px;
  border-radius: 4px;
}

===== admin-events-app.js =====
import { db } from './firebase-config.js';
import { ref, push, onValue } from "firebase/database";

// المناسبات
const addEventForm = document.getElementById("addEventForm");
const eventNameInput = document.getElementById("eventName");
const eventDateInput = document.getElementById("eventDate");
const eventList = document.getElementById("eventList");

addEventForm.addEventListener("submit", e => {
  e.preventDefault();
  const name = eventNameInput.value.trim();
  const date = eventDateInput.value;
  if (name && date) {
    push(ref(db, 'events'), { name, date });
    eventNameInput.value = '';
    eventDateInput.value = '';
  }
});

onValue(ref(db, 'events'), snapshot => {
  eventList.innerHTML = '';
  snapshot.forEach(child => {
    const event = child.val();
    const li = document.createElement("li");
    li.textContent = `${event.name} - ${event.date}`;
    eventList.appendChild(li);
  });
});

// المهمات
const addTaskForm = document.getElementById("addTaskForm");
const taskNameInput = document.getElementById("taskName");
const taskOwnerInput = document.getElementById("taskOwner");
const taskDeadlineInput = document.getElementById("taskDeadline");
const taskList = document.getElementById("taskList");

addTaskForm.addEventListener("submit", e => {
  e.preventDefault();
  const name = taskNameInput.value.trim();
  const owner = taskOwnerInput.value.trim();
  const deadline = taskDeadlineInput.value;
  if (name && owner && deadline) {
    push(ref(db, 'tasks'), { name, owner, deadline, status: "قيد التنفيذ" });
    taskNameInput.value = '';
    taskOwnerInput.value = '';
    taskDeadlineInput.value = '';
  }
});

onValue(ref(db, 'tasks'), snapshot => {
  taskList.innerHTML = '';
  snapshot.forEach(child => {
    const task = child.val();
    const li = document.createElement("li");
    li.textContent = `${task.name} - المسؤول: ${task.owner} - الموعد: ${task.deadline} - الحالة: ${task.status}`;
    taskList.appendChild(li);
  });
});

// أعياد الميلاد
const addBirthdayForm = document.getElementById("addBirthdayForm");
const birthdayNameInput = document.getElementById("birthdayName");
const birthdayDateInput = document.getElementById("birthdayDate");
const birthdayList = document.getElementById("birthdayList");

addBirthdayForm.addEventListener("submit", e => {
  e.preventDefault();
  const name = birthdayNameInput.value.trim();
  const date = birthdayDateInput.value;
  if (name && date) {
    push(ref(db, 'birthdays'), { name, date });
    birthdayNameInput.value = '';
    birthdayDateInput.value = '';
  }
});

onValue(ref(db, 'birthdays'), snapshot => {
  birthdayList.innerHTML = '';
  snapshot.forEach(child => {
    const birthday = child.val();
    const li = document.createElement("li");
    li.textContent = `${birthday.name} - ${birthday.date}`;
    birthdayList.appendChild(li);
  });
});
===== admin-stats.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>التقارير والإحصائيات - Talanton</title>
  <link rel="stylesheet" href="admin-stats-style.css">
</head>
<body>
  <h1>التقارير والإحصائيات</h1>

  <section>
    <h2>إحصائيات عامة</h2>
    <ul id="generalStats"></ul>
  </section>

  <section>
    <h2>توزيع Talanton بين الأعضاء</h2>
    <ul id="distributionList"></ul>
  </section>

  <section>
    <h2>أفضل 10 أعضاء</h2>
    <ol id="topMembers"></ol>
  </section>

  <script type="module" src="admin-stats-app.js"></script>
</body>
</html>

===== admin-stats-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #f0f8ff;
  padding: 20px;
}

section {
  background: #fff;
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 8px;
}

ul, ol {
  list-style: none;
  padding: 0;
}

li {
  background: #f0f0f0;
  margin-bottom: 5px;
  padding: 10px;
  border-radius: 4px;
}

===== admin-stats-app.js =====
import { db } from './firebase-config.js';
import { ref, onValue } from "firebase/database";

// إحصائيات عامة
const generalStats = document.getElementById("generalStats");

function updateGeneralStats() {
  let memberCount = 0;
  let weekCount = 0;
  let attendanceCount = 0;
  let totalTalanton = 0;

  onValue(ref(db, 'members'), snapshot => {
    memberCount = snapshot.size;
    renderStats();
  });

  onValue(ref(db, 'weeks'), snapshot => {
    weekCount = snapshot.size;
    renderStats();
  });

  onValue(ref(db, 'attendance'), snapshot => {
    attendanceCount = snapshot.size;
    snapshot.forEach(child => {
      totalTalanton += child.val().talanton || 0;
    });
    renderStats();
  });

  function renderStats() {
    generalStats.innerHTML = `
      <li>إجمالي الأعضاء: ${memberCount}</li>
      <li>عدد الأسابيع: ${weekCount}</li>
      <li>إجمالي الحضور: ${attendanceCount}</li>
      <li>Talanton الممنوحة: ${totalTalanton}</li>
    `;
  }
}

updateGeneralStats();

// توزيع Talanton
const distributionList = document.getElementById("distributionList");

onValue(ref(db, 'members'), snapshot => {
  distributionList.innerHTML = '';
  snapshot.forEach(member => {
    const memberId = member.key;
    const memberName = member.val().name;
    let total = 0;

    onValue(ref(db, 'attendance'), attendanceSnapshot => {
      attendanceSnapshot.forEach(att => {
        if (att.val().memberId === memberId) {
          total += att.val().talanton || 0;
        }
      });

      const li = document.createElement("li");
      li.textContent = `${memberName}: ${total} Talanton`;
      distributionList.appendChild(li);
    }, { onlyOnce: true });
  });
});

// أفضل 10 أعضاء
const topMembers = document.getElementById("topMembers");

function updateTopMembers() {
  const scores = {};

  onValue(ref(db, 'attendance'), snapshot => {
    snapshot.forEach(att => {
      const memberId = att.val().memberId;
      const points = att.val().talanton || 0;
      scores[memberId] = (scores[memberId] || 0) + points;
    });

    const sorted = Object.entries(scores)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 10);

    topMembers.innerHTML = '';
    sorted.forEach(([id, score]) => {
      onValue(ref(db, `members/${id}`), memberSnap => {
        const li = document.createElement("li");
        li.textContent = `${memberSnap.val().name} - ${score} Talanton`;
        topMembers.appendChild(li);
      }, { onlyOnce: true });
    });
  });
}

updateTopMembers();
===== admin-login.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>تسجيل دخول الأدمن - Talanton</title>
  <link rel="stylesheet" href="admin-login-style.css">
</head>
<body>
  <h1>تسجيل دخول الأدمن</h1>

  <form id="loginForm">
    <input type="password" id="adminPassword" placeholder="كلمة السر">
    <button type="submit">دخول</button>
  </form>

  <p id="loginStatus"></p>

  <script type="module" src="admin-login-app.js"></script>
</body>
</html>

===== admin-login-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #fff0f0;
  padding: 20px;
}

form {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  max-width: 400px;
  margin: auto;
}

input, button {
  display: block;
  margin-bottom: 15px;
  width: 100%;
  padding: 8px;
}

#loginStatus {
  text-align: center;
  font-weight: bold;
  color: green;
}

===== admin-login-app.js =====
import { db } from './firebase-config.js';
import { ref, get, push } from "firebase/database";

const loginForm = document.getElementById("loginForm");
const adminPasswordInput = document.getElementById("adminPassword");
const loginStatus = document.getElementById("loginStatus");

loginForm.addEventListener("submit", async e => {
  e.preventDefault();
  const enteredPassword = adminPasswordInput.value.trim();

  const passwordRef = ref(db, 'admin/password');
  const snapshot = await get(passwordRef);

  const correctPassword = snapshot.exists() ? snapshot.val() : null;

  const attempt = {
    user: "admin",
    timestamp: Date.now(),
    status: enteredPassword === correctPassword ? "ناجحة" : "فاشلة"
  };

  push(ref(db, 'loginAttempts'), attempt);

  if (enteredPassword === correctPassword) {
    loginStatus.textContent = "تم تسجيل الدخول بنجاح!";
    loginStatus.style.color = "green";
    // هنا ممكن تضيف توجيه لصفحة الأدمن
    // window.location.href = "admin.html";
  } else {
    loginStatus.textContent = "كلمة السر غير صحيحة!";
    loginStatus.style.color = "red";
  }

  adminPasswordInput.value = '';
});
===== admin-backup.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>النسخ الاحتياطي وتصدير البيانات - Talanton</title>
  <link rel="stylesheet" href="admin-backup-style.css">
</head>
<body>
  <h1>النسخ الاحتياطي وتصدير البيانات</h1>

  <section>
    <h2>تصدير بيانات الأعضاء</h2>
    <button id="exportMembers">تصدير</button>
  </section>

  <section>
    <h2>تصدير تقرير الحضور</h2>
    <button id="exportAttendance">تصدير</button>
  </section>

  <section>
    <h2>نسخ احتياطي كامل</h2>
    <button id="backupAll">نسخ احتياطي</button>
  </section>

  <script type="module" src="admin-backup-app.js"></script>
</body>
</html>

===== admin-backup-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #f9f9ff;
  padding: 20px;
}

section {
  background: #fff;
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 8px;
}

button {
  display: block;
  margin-top: 10px;
  width: 100%;
  padding: 10px;
  font-weight: bold;
}

===== admin-backup-app.js =====
import { db } from './firebase-config.js';
import { ref, get } from "firebase/database";

function downloadJSON(data, filename) {
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}

// تصدير الأعضاء
document.getElementById("exportMembers").addEventListener("click", async () => {
  const snapshot = await get(ref(db, 'members'));
  if (snapshot.exists()) {
    downloadJSON(snapshot.val(), "members_backup.json");
  } else {
    alert("لا توجد بيانات أعضاء.");
  }
});

// تصدير الحضور
document.getElementById("exportAttendance").addEventListener("click", async () => {
  const snapshot = await get(ref(db, 'attendance'));
  if (snapshot.exists()) {
    downloadJSON(snapshot.val(), "attendance_backup.json");
  } else {
    alert("لا توجد بيانات حضور.");
  }
});

// نسخ احتياطي كامل
document.getElementById("backupAll").addEventListener("click", async () => {
  const paths = ['members', 'attendance', 'weeks', 'store', 'tasks', 'events', 'birthdays'];
  const backup = {};

  for (const path of paths) {
    const snapshot = await get(ref(db, path));
    backup[path] = snapshot.exists() ? snapshot.val() : {};
  }

  downloadJSON(backup, "talanton_full_backup.json");
});
===== admin-songs.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>إدارة الترنيمات - Talanton</title>
  <link rel="stylesheet" href="admin-songs-style.css">
</head>
<body>
  <h1>إدارة الترنيمات</h1>

  <section>
    <h2>إضافة ترنيمة جديدة</h2>
    <form id="addSongForm">
      <input type="text" id="songTitle" placeholder="عنوان الترنيمة">
      <input type="text" id="songLink" placeholder="رابط الترنيمة (اختياري)">
      <button type="submit">إضافة</button>
    </form>
    <ul id="songList"></ul>
  </section>

  <section>
    <h2>اختيار ترنيمة للاجتماع القادم</h2>
    <select id="songSelect"></select>
    <button id="selectSongBtn">اختيار</button>
    <p id="selectedSongDisplay"></p>
  </section>

  <script type="module" src="admin-songs-app.js"></script>
</body>
</html>

===== admin-songs-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #fefefe;
  padding: 20px;
}

section {
  background: #fff;
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 8px;
}

input, select, button {
  display: block;
  margin-bottom: 10px;
  width: 100%;
  padding: 8px;
}

ul {
  list-style: none;
  padding: 0;
}

li {
  background: #f0f0f0;
  margin-bottom: 5px;
  padding: 10px;
  border-radius: 4px;
}

===== admin-songs-app.js =====
import { db } from './firebase-config.js';
import { ref, push, onValue, set } from "firebase/database";

// إضافة ترنيمة
const addSongForm = document.getElementById("addSongForm");
const songTitleInput = document.getElementById("songTitle");
const songLinkInput = document.getElementById("songLink");
const songList = document.getElementById("songList");

addSongForm.addEventListener("submit", e => {
  e.preventDefault();
  const title = songTitleInput.value.trim();
  const link = songLinkInput.value.trim();
  if (title) {
    push(ref(db, 'songs'), { title, link });
    songTitleInput.value = '';
    songLinkInput.value = '';
  }
});

onValue(ref(db, 'songs'), snapshot => {
  songList.innerHTML = '';
  songSelect.innerHTML = '';
  snapshot.forEach(child => {
    const song = child.val();
    const li = document.createElement("li");
    li.textContent = song.title + (song.link ? ` - ${song.link}` : '');
    songList.appendChild(li);

    const option = document.createElement("option");
    option.value = child.key;
    option.textContent = song.title;
    songSelect.appendChild(option);
  });
});

// اختيار ترنيمة للاجتماع
const songSelect = document.getElementById("songSelect");
const selectSongBtn = document.getElementById("selectSongBtn");
const selectedSongDisplay = document.getElementById("selectedSongDisplay");

selectSongBtn.addEventListener("click", () => {
  const selectedId = songSelect.value;
  if (selectedId) {
    set(ref(db, 'selectedSong'), selectedId);
    selectedSongDisplay.textContent = "تم اختيار الترنيمة بنجاح!";
  }
});

// عرض الترنيمة المختارة
onValue(ref(db, 'selectedSong'), snapshot => {
  const songId = snapshot.val();
  if (songId) {
    onValue(ref(db, `songs/${songId}`), songSnap => {
      const song = songSnap.val();
      selectedSongDisplay.textContent = `الترنيمة المختارة: ${song.title}`;
    }, { onlyOnce: true });
  }
});
===== admin-home.html =====
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>الصفحة الرئيسية - Talanton</title>
  <link rel="stylesheet" href="admin-home-style.css">
</head>
<body>
  <h1>لوحة تحكم Talanton</h1>

  <nav>
    <ul>
      <li><a href="admin-login.html">تسجيل دخول الأدمن</a></li>
      <li><a href="admin.html">إدارة الأعضاء والأسابيع</a></li>
      <li><a href="admin-extended.html">الحضور والمتجر والتقارير</a></li>
      <li><a href="admin-security.html">إعدادات الأمان</a></li>
      <li><a href="admin-events.html">المناسبات والمهمات وأعياد الميلاد</a></li>
      <li><a href="admin-stats.html">الإحصائيات والتقارير</a></li>
      <li><a href="admin-backup.html">النسخ الاحتياطي والتصدير</a></li>
      <li><a href="admin-songs.html">إدارة الترنيمات</a></li>
    </ul>
  </nav>
</body>
</html>

===== admin-home-style.css =====
body {
  font-family: 'Arial', sans-serif;
  direction: rtl;
  background-color: #f0f0f0;
  padding: 20px;
  text-align: center;
}

h1 {
  margin-bottom: 30px;
}

nav ul {
  list-style: none;
  padding: 0;
}

nav li {
  margin-bottom: 15px;
}

nav a {
  display: block;
  background-color: #007bff;
  color: white;
  text-decoration: none;
  padding: 10px;
  border-radius: 5px;
  width: 300px;
  margin: auto;
  transition: background-color 0.3s;
}

nav a:hover {
  background-color: #0056b3;
}
