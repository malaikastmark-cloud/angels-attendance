<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª</title>
<style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f6f8; }
    header { background:#3498db; color:white; padding:15px; text-align:center; font-size:1.5em; }
    main { padding:20px; max-width:1200px; margin:auto; }
    .card { background:white; padding:20px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.1); margin-bottom:20px; }
    select,input,button { padding:8px; margin:5px 0; border-radius:5px; border:1px solid #ccc; }
    button { cursor:pointer; background:#3498db; color:white; border:none; }
    button:hover { background:#2980b9; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th,td { border:1px solid #ddd; padding:8px; text-align:center; }
    th { background:#3498db; color:white; }
    .member-img { width:40px; height:40px; border-radius:50%; }
    #adminTabs { display:none; }
    #notification { position:fixed; top:20px; right:20px; padding:10px 20px; color:white; border-radius:5px; display:none; }
    .top-member-item { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; padding:10px; border-bottom:1px solid #ddd; }
    .medal { margin-right:5px; }
    .member-stats { display:flex; align-items:center; margin-bottom:10px; background:#fafafa; padding:10px; border-radius:5px; }
    .member-stat-item { margin-right:15px; }
    #adminLoginModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); justify-content:center; align-items:center; }
    #adminLoginModal .modal-content { background:white; padding:20px; border-radius:10px; width:300px; text-align:center; }
    .login-failed { animation:shake 0.5s; border-color:red; }
    @keyframes shake { 0%{transform:translateX(0);} 25%{transform:translateX(-5px);} 50%{transform:translateX(5px);} 75%{transform:translateX(-5px);} 100%{transform:translateX(0);} }
    canvas { max-width:100%; }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
<header>Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª</header>
<main>

<!-- Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
<div id="notification"></div>

<!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
<div id="userAttendance" class="card">
    <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±</h2>
    <select id="selectMember"></select>
    <select id="weekSelect"></select>
    <button id="markPresent">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±</button>
    <br>
    <button id="adminLoginBtn">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙƒØ£Ø¯Ù…Ù†</button>
    <h3>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h3>
    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¶ÙˆØ±: <span id="attendanceCount">0</span></p>
    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="totalPoints">0</span></p>
    <canvas id="attendanceChart"></canvas>
</div>

<!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø¯Ù…Ù† -->
<div id="adminTabs">

    <button id="backToUserView">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</button>

    <div class="card">
        <h2>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</h2>
        <input type="text" id="newMemberName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ">
        <input type="text" id="newMemberEmoji" placeholder="Ø¥ÙŠÙ…ÙˆØ¬ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
        <input type="text" id="newMemberImage" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø¹Ø¶Ùˆ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
        <button id="addMemberBtn">Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ</button>
        <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: <span id="totalMembers">0</span></p>
        <table id="membersTable">
            <thead><tr><th>#</th><th>ØµÙˆØ±Ø©</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th><th>Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</th><th>ØªØ¹Ø¯ÙŠÙ„</th><th>Ø­Ø°Ù</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="card">
        <h2>Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹</h2>
        <input type="text" id="newWeekName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹">
        <input type="date" id="newWeekStart">
        <input type="date" id="newWeekEnd">
        <button id="addWeekBtn">Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¨ÙˆØ¹</button>
        <table id="weeksTable">
            <thead><tr><th>#</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ù…Ù†</th><th>Ø¥Ù„Ù‰</th><th>ØªØ¹Ø¯ÙŠÙ„</th><th>Ø­Ø°Ù</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="card">
        <h2>Ø§Ù„Ø­Ø¶ÙˆØ±</h2>
        <select id="extraPointMember"></select>
        <input type="number" id="extraPointsValue" value="1" min="1" style="width:60px">
        <input type="text" id="extraPointsReason" placeholder="Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø¶Ø§ÙØ©">
        <button id="addExtraPointsBtn">Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø· Ø¥Ø¶Ø§ÙÙŠØ©</button>
        <select id="deleteWeekSelect"></select>
        <button id="deleteAttendanceBtn">Ø­Ø°Ù Ø­Ø¶ÙˆØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</button>
        <table id="attendanceRecordsBody">
            <thead><tr><th>#</th><th>Ø§Ù„Ø¹Ø¶Ùˆ</th><th>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø­Ø°Ù</th></tr></thead>
            <tbody id="attendanceRecordsBody"></tbody>
        </table>
    </div>

    <div class="card">
        <h2>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·</h2>
        <div id="topMembersList"></div>
    </div>

    <div class="card">
        <h2>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</h2>
        <div id="membersStatsContainer"></div>
    </div>

    <div class="card">
        <button id="printReportBtn">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
        <button id="exportExcelBtn">ØªØµØ¯ÙŠØ± Ù„Ø¥ÙƒØ³Ù„</button>
    </div>
</div>

<!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† -->
<div id="adminLoginModal">
    <div class="modal-content">
        <h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†</h3>
        <input type="password" id="adminPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
        <br>
        <button id="confirmAdminLogin">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
        <button id="cancelAdminLogin">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
</div>

<script>
// Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„ÙŠØ©
let members = [];
let weeks = [];
let attendanceRecords = [];
let rewards = [];
let extraPoints = [];
let events = [];
let tasks = [];

const adminPass = 'admin123';

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
function initializeApp() {
    populateData();
    setupEventListeners();
}

// ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
function populateData() {
    populateMembers();
    populateWeeks();
    populateAttendanceTable();
    updateAttendanceStats();
}

// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡
function populateMembers() {
    const selectMember = document.getElementById('selectMember');
    const extraPointMember = document.getElementById('extraPointMember');
    selectMember.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ø³Ù…Ùƒ --</option>';
    extraPointMember.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø¶Ùˆ --</option>';
    members.forEach(member => {
        let option = document.createElement('option'); option.value = member.id; option.textContent = member.name; selectMember.appendChild(option);
        let opt2 = document.createElement('option'); opt2.value = member.id; opt2.textContent = member.name; extraPointMember.appendChild(opt2);
    });
    const membersTbody = document.querySelector('#membersTable tbody'); membersTbody.innerHTML = '';
    members.forEach((member,index)=>{ 
        let tr = document.createElement('tr'); 
        tr.innerHTML = `<td>${index+1}</td><td><img src="${member.image}" class="member-img"></td><td>${member.name}</td><td>${member.points}</td><td>${rewards.filter(r=>r.memberId===member.id).map(r=>r.title).join(', ')||'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</td><td><button class='btn btn-primary editMember' data-id='${member.id}'>ØªØ¹Ø¯ÙŠÙ„</button></td><td><button class='btn btn-danger deleteMember' data-id='${member.id}'>Ø­Ø°Ù</button></td>`; 
        membersTbody.appendChild(tr); 
    });
    document.getElementById('totalMembers').textContent = members.length;
}

// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹
function populateWeeks() {
    const weekSelect = document.getElementById('weekSelect');
    const deleteWeekSelect = document.getElementById('deleteWeekSelect');
    weekSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ --</option>';
    deleteWeekSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ --</option>';
    weeks.forEach(week => {
        let opt = document.createElement('option'); opt.value = week.id; opt.textContent = week.name; weekSelect.appendChild(opt);
        let opt2 = document.createElement('option'); opt2.value = week.id; opt2.textContent = week.name; deleteWeekSelect.appendChild(opt2);
    });
    const weeksTbody = document.querySelector('#weeksTable tbody'); weeksTbody.innerHTML = '';
    weeks.forEach((week,index)=>{ 
        let tr = document.createElement('tr'); 
        tr.innerHTML = `<td>${index+1}</td><td>${week.name}</td><td>${week.from}</td><td>${week.to}</td><td><button class='btn btn-primary editWeek' data-id='${week.id}'>ØªØ¹Ø¯ÙŠÙ„</button></td><td><button class='btn btn-danger deleteWeek' data-id='${week.id}'>Ø­Ø°Ù</button></td>`; 
        weeksTbody.appendChild(tr); 
    });
}

// Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±
function populateAttendanceTable() {
    const tbody = document.getElementById('attendanceRecordsBody');
    tbody.innerHTML = '';
    if(attendanceRecords.length===0){ tbody.innerHTML='<tr><td colspan="5">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø­Ø¶ÙˆØ±</td></tr>'; return;}
    attendanceRecords.forEach((record,index)=>{ 
        let member = members.find(m=>m.id===record.memberId); 
        let week = weeks.find(w=>w.id==record.weekId);
        if(member&&week){ 
            let tr=document.createElement('tr'); 
            tr.innerHTML=`<td>${index+1}</td><td>${member.name}</td><td>${week.name}</td><td>${new Date(record.date).toLocaleString('ar-EG')}</td><td><button class='btn btn-danger deleteAttendance' data-id='${record.id}'>Ø­Ø°Ù</button></td>`;
            tbody.appendChild(tr);
        } 
    });
}

// ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
function updateAttendanceStats() { const selectedWeekId = document.getElementById('weekSelect').value; let count=0; let totalPoints=0; if(!selectedWeekId){ document.getElementById('attendanceCount').textContent=count; document.getElementById('totalPoints').textContent=totalPoints; return;} const weekAttendance=attendanceRecords.filter(ar=>ar.weekId==selectedWeekId); count=weekAttendance.length; totalPoints=members.reduce((sum,m)=>sum+m.points,0); document.getElementById('attendanceCount').textContent=count; document.getElementById('totalPoints').textContent=totalPoints; updateChart(); updateTopMembers(); }

// Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡
function updateTopMembers(){ const memberPoints=members.map(m=>({name:m.name,points:m.points,image:m.image})); memberPoints.sort((a,b)=>b.points-a.points); const top10=memberPoints.slice(0,10); const topMembersList=document.getElementById('topMembersList'); topMembersList.innerHTML=''; top10.forEach((member,index)=>{ let medal=''; if(index===0)medal='ğŸ¥‡'; else if(index===1)medal='ğŸ¥ˆ'; else if(index===2)medal='ğŸ¥‰'; let div=document.createElement('div'); div.className='top-member-item'; div.innerHTML=`<div style="display:flex;align-items:center;gap:10px;"><img src="${member.image}" class="member-img"><div>${medal} ${member.name}</div></div><div>${member.points} Ù†Ù‚Ø·Ø©</div>`; topMembersList.appendChild(div); }); }

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
function setupEventListeners(){
document.getElementById('adminLoginBtn').addEventListener('click',()=>{document.getElementById('adminLoginModal').style.display='flex'; document.getElementById('adminPassword').value='';});
document.getElementById('cancelAdminLogin').addEventListener('click',()=>{document.getElementById('adminLoginModal').style.display='none';});
document.getElementById('confirmAdminLogin').addEventListener('click',()=>{const pwd=document.getElementById('adminPassword').value; if(pwd===adminPass){document.getElementById('adminLoginModal').style.display='none'; document.getElementById('adminTabs').style.display='block'; document.getElementById('userAttendance').style.display='none'; document.getElementById('adminLoginBtn').style.display='none'; showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­');} else{ const passInput=document.getElementById('adminPassword'); passInput.classList.add('login-failed'); setTimeout(()=>{passInput.classList.remove('login-failed');},500); showNotification('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø©!',false);}});
document.getElementById('backToUserView').addEventListener('click',()=>{document.getElementById('adminTabs').style.display='none'; document.getElementById('userAttendance').style.display='block'; document.getElementById('adminLoginBtn').style.display='block';});
document.getElementById('addMemberBtn').addEventListener('click',()=>{const name=document.getElementById('newMemberName').value; const emoji=document.getElementById('newMemberEmoji').value; const image=document.getElementById('newMemberImage').value; if(!name){showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ',false); return;} const newMember={id:members.length>0?Math.max(...members.map(m=>m.id))+1:1,name:`${emoji} ${name}`,image:image||`https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=3498db&color=fff`,points:0}; members.push(newMember); showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¶Ùˆ Ø¨Ù†Ø¬Ø§Ø­'); document.getElementById('newMemberName').value=''; document.getElementById('newMemberImage').value=''; populateData();});
document.getElementById('addWeekBtn').addEventListener('click',()=>{const name=document.getElementById('newWeekName').value; const from=document.getElementById('newWeekStart').value; const to=document.getElementById('newWeekEnd').value; if(!name||!from||!to){showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„',false);return;} const newWeek={id:weeks.length>0?Math.max(...weeks.map(w=>w.id))+1:1,name:name,from:from,to:to}; weeks.push(newWeek); showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­'); document.getElementById('newWeekName').value=''; document.getElementById('newWeekStart').value=''; document.getElementById('newWeekEnd').value=''; populateData();});
document.getElementById('markPresent').addEventListener('click',()=>{const memberId=parseInt(document.getElementById('selectMember').value); const weekId=parseInt(document.getElementById('weekSelect').value); if(!memberId||!weekId){showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ø¶Ùˆ ÙˆØ§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø£ÙˆÙ„Ø§Ù‹',false);return;} const existing=attendanceRecords.find(ar=>ar.memberId===memberId&&ar.weekId==weekId); if(existing){showNotification('Ù„Ù‚Ø¯ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø¶Ùˆ already ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',false);return;} const newAttendance={id:attendanceRecords.length>0?Math.max(...attendanceRecords.map(ar=>ar.id))+1:1,memberId:memberId,weekId:weekId,date:new Date().toISOString()}; attendanceRecords.push(newAttendance); const member=members.find(m=>m.id===memberId); if(member){member.points+=1;} showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!'); populateData();});
document.getElementById('addExtraPointsBtn').addEventListener('click',()=>{const memberId=parseInt(document.getElementById('extraPointMember').value); const points=parseInt(document.getElementById('extraPointsValue').value); const reason=document.getElementById('extraPointsReason').value; if(!memberId||!points||!reason){showNotification('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„',false);return;} const member=members.find(m=>m.id===memberId); if(member){member.points+=points; extraPoints.push({id:extraPoints.length>0?Math.max(...extraPoints.map(ep=>ep.id))+1:1,memberId:memberId,points:points,reason:reason,date:new Date().toISOString()}); showNotification(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${points} Ù†Ù‚Ø·Ø© Ø¥Ù„Ù‰ ${member.name} Ø¨Ø³Ø¨Ø¨: ${reason}`); document.getElementById('extraPointsValue').value='1'; document.getElementById('extraPointsReason').value=''; populateData();}});
document.getElementById('deleteAttendanceBtn').addEventListener('click',()=>{const weekId=parseInt(document.getElementById('deleteWeekSelect').value); if(!weekId){showNotification('Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ù„Ù„Ø­Ø°Ù',false);return;} attendanceRecords=attendanceRecords.filter(ar=>ar.weekId!=weekId); showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù…Ø®ØªØ§Ø±'); populateData();});
document.getElementById('printReportBtn').addEventListener('click',()=>{window.print();});
document.getElementById('exportExcelBtn').addEventListener('click',()=>{ const ws=XLSX.utils.json_to_sheet(members.map(m=>({ID:m.id,Ø§Ø³Ù…:m.name,Ù†Ù‚Ø§Ø·:m.points}))); const wb=XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb,ws,'Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡'); XLSX.writeFile(wb,'members.xlsx'); });
document.getElementById('weekSelect').addEventListener('change',updateAttendanceStats);
}

// Ø¥Ø´Ø¹Ø§Ø±
function showNotification(msg,success=true){ const note=document.getElementById('notification'); note.textContent=msg; note.style.backgroundColor=success?'#27ae60':'#e74c3c'; note.style.display='block'; setTimeout(()=>{note.style.display='none';},3000);}

// Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ
let chart=null;
function updateChart(){ const ctx=document.getElementById('attendanceChart').getContext('2d'); const weekId=parseInt(document.getElementById('weekSelect').value); if(!weekId){if(chart){chart.destroy();} return;} const weekAttendance=attendanceRecords.filter(ar=>ar.weekId==weekId); const labels=members.map(m=>m.name); const data=members.map(m=>weekAttendance.filter(ar=>ar.memberId==m.id).length); if(chart){chart.destroy();} chart=new Chart(ctx,{type:'bar',data:{labels:labels,datasets:[{label:'Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¶ÙˆØ±',data:data,backgroundColor:'#3498db'}]},options:{responsive:true,plugins:{legend:{display:false}}}});}

// Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
initializeApp();
</script>
</main>
</body>
</html>
